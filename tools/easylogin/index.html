<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><text y='14'>ü¶ñ</text></svg>">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>easyLogin-2FA</title>
    <script src="https://cdn.jsdelivr.net/npm/otplib/otplib-browser.min.js"></script>

    
    <!-- Essential SEO -->
<meta name="description" content="easyLogin ‚Äî a fast, minimalist TOTP 2FA generator. Instantly generate secure one-time codes from any Base32 secret. No signup, no clutter, 100% private.">
<meta name="keywords" content="2FA, TOTP, authenticator, easy login, Base32, otp generator, totp generator, easyLogin">
<meta name="author" content="teerex ü¶ñ">

<!-- Open Graph (Improves link previews on WhatsApp, Twitter, Facebook) -->
<meta property="og:title" content="easyLogin‚Ñ¢ ‚Äî built by teerex ü¶ñ">
<meta property="og:description" content="Instant 2FA (TOTP) generator. Paste your secret, get your login code. Clean, private, fast.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://fastaccs.com/tools/easylogin/">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="easyLogin‚Ñ¢ ‚Äî built by teerex ü¶ñ">
<meta name="twitter:description" content="Minimal, fast 2FA code generator. Built for speed, privacy, and simplicity.">

<!-- Mobile & Crawlers -->
<meta name="theme-color" content="#07090C">
<meta name="robots" content="index, follow">
<meta name="googlebot" content="index, follow">

<!-- Canonical URL -->
<link rel="canonical" href="https://fastaccs.com/tools/easylogin/">

<!-- Structured Data (Boosts Google SEO) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "easyLogin",
  "url": "https://fastaccs.com/tools/easylogin/",
  "description": "A lightweight TOTP 2FA generator that instantly creates secure one-time login codes.",
  "applicationCategory": "SecurityApplication",
  "operatingSystem": "All",
  "creator": {
    "@type": "Person",
    "name": "teerex"
  }
}
</script>



    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@500;600;700&family=Open+Sans:wght@400;500;600&family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="fa-style.css">

    <style>
        /* All styles are now in fa-style.css - this tag is kept for any inline styles if needed */
    </style>
</head>
<body>
    <div class="page-wrapper">
        <div>
            <div class="page-title"> easyLogin‚Ñ¢ </div>
            <div class="container">
                <div id="mainDisplay">
                    <!-- Dynamic content will be inserted here -->
                </div>
                
                <div id="manualEntry" style="display: none;">
                    <div class="input-group">
                        <input 
                            type="text" 
                            id="secretInput" 
                            placeholder="Paste Base32 secret here (A-Z, 2-7)" 
                            autocomplete="off"
                            autocapitalize="off"
                            autocorrect="off"
                            spellcheck="false"
                        />
                        <div class="input-hint">Typically 16-32 characters, letters A-Z and numbers 2-7 only</div>
                        <div id="inputError" class="error-message"></div>
                    </div>
                    <div class="action-buttons">
                        <button id="generateBtn" onclick="startFromInput()">GENERATE</button>
                        <button id="clearBtn" onclick="clearInput()" class="clear-btn" disabled>CLEAR</button>
                    </div>
                </div>
            </div>
            
            <div class="marketing-section">
                <p class="marketing-headline">Need social media accounts?</p>
                <p class="marketing-subtext" style="margin-bottom: 20px; opacity: 1; font-size: 0.85rem;">Buy verified accounts from a trusted marketplace ‚Äî instant delivery, secure payments.</p>
                <a href="https://fastaccs.com" class="marketing-link" target="_blank" rel="noopener noreferrer">SHOP FASTACCS ‚Üí</a>
                <a href="https://chat.whatsapp.com/L4pqTeTiKIF9AXcbpvMLCo" class="marketing-link-secondary" target="_blank" rel="noopener noreferrer">JOIN COMMUNITY</a>
                <p class="marketing-subtext"></p>
            </div>
        </div>
    </div>

<div class="page-footer">
    <a href="https://www.rottenlibrary.net/#gsc.tab=0" class="trex-link" target="_blank">by teerex ü¶ñ</a>
</div>

    <div id="copyToast" class="toast">Code copied! ‚úì</div>

    <script>
        let generateToken;
        let currentInterval;

        function cleanSecretInput(secret) {
            // Remove spaces, dashes, underscores and convert to uppercase
            return secret.replace(/[\s\-_]/g, '').toUpperCase();
        }

        function isValidBase32(str) {
            // More comprehensive Base32 validation
            const base32Regex = /^[A-Z2-7]+=*$/i;
            if (!base32Regex.test(str)) return false;
            
            // Additional validation: should be reasonable length for 2FA (usually 16, 32, etc.)
            const cleanStr = str.replace(/=+$/, ''); // Remove padding
            return cleanStr.length >= 16 && cleanStr.length <= 64;
        }

        function validateInput(secret) {
            const secretInput = document.getElementById('secretInput');
            const errorElement = document.getElementById('inputError');
            const generateBtn = document.getElementById('generateBtn');
            
            // Clear previous errors
            secretInput.classList.remove('input-error', 'shake');
            errorElement.classList.remove('show');
            
            if (!secret || secret.trim() === '') {
                showError('Please enter a 2FA secret key');
                return false;
            }
            
            // Clean the input first (remove spaces, dashes, underscores)
            const cleanedSecret = cleanSecretInput(secret);
            
            // Check for common mistakes
            if (cleanedSecret.length < 16) {
                showError('Secret seems too short. 2FA keys are usually 16+ characters');
                return false;
            }
            
            if (cleanedSecret.length > 64) {
                showError('Secret seems too long. Please check your input');
                return false;
            }
            
            // Check for obviously invalid patterns
            if (/^\d+$/.test(cleanedSecret)) {
                showError('This appears to be only numbers. 2FA secrets use Base32 (A-Z, 2-7)');
                return false;
            }
            
            if (!isValidBase32(cleanedSecret)) {
                showError('Invalid format. Use only Base32 characters: A-Z and 2-7');
                return false;
            }
            
            return true;
        }

        function showError(message) {
            const secretInput = document.getElementById('secretInput');
            const errorElement = document.getElementById('inputError');
            
            secretInput.classList.add('input-error', 'shake');
            errorElement.textContent = message;
            errorElement.classList.add('show');
            
            // Remove shake animation after it completes
            setTimeout(() => {
                secretInput.classList.remove('shake');
            }, 500);
        }

        function startFromInput() {
            const secret = document.getElementById('secretInput').value.trim();
            const generateBtn = document.getElementById('generateBtn');
            
            if (!validateInput(secret)) {
                return;
            }
            
            // Clean the secret before using it
            const cleanedSecret = cleanSecretInput(secret);
            
            // Add loading state
            generateBtn.innerHTML = '‚è≥ GENERATING';
            generateBtn.disabled = true;
            
            // Small delay to show loading state
            setTimeout(() => {
                renderCode(cleanedSecret);
                generateBtn.innerHTML = 'GENERATE';
                generateBtn.disabled = false;
            }, 100);
        }

        function renderCode(secret) {
            if (!secret) {
                document.getElementById('manualEntry').style.display = "block";
                document.getElementById('mainDisplay').innerHTML = `
                    <div style="margin: 20px 0; opacity: 0.8;">
                        <p>Enter your 2FA secret key to generate codes</p>
                    </div>
                `;
                return;
            }

            try {
                // Clear any existing interval
                if (currentInterval) {
                    clearInterval(currentInterval);
                }

                const token = generateToken(secret);
                document.getElementById('manualEntry').style.display = "none";
                const mainDiv = document.getElementById('mainDisplay');
                
                // Mask secret for display (show first 4 and last 4 chars with dots)
                const maskSecret = (str) => {
                    if (str.length <= 8) return str;
                    return `${str.substring(0, 4)}‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢${str.substring(str.length - 4)}`;
                };
                const displaySecret = maskSecret(secret);

                mainDiv.innerHTML = `
                    <div class="code">${formatCode(token)}</div>
                    <div class="timer">‚è± Expires in <span id="countdown">30</span>s</div>
                    <div class="secret-display">
                        Secret: ${displaySecret}
                    </div>
                    <div class="action-buttons">
                        <button onclick="copyCode()" class="copy-btn">COPY üìã</button>
                        <button onclick="goHome()" class="home-btn">HOME üè†</button>
                    </div>
                `;

                // Start the countdown immediately
                updateCountdown(secret);

                // Set up interval for countdown
                currentInterval = setInterval(() => updateCountdown(secret), 1000);

            } catch (error) {
                document.getElementById('mainDisplay').innerHTML = `
                    <div style="color: var(--error); margin: 20px 0;">
                        <p style="font-weight: bold;">‚ùå ${error.message}</p>
                        <p style="font-size: 0.9em; margin-top: 10px; color: var(--neutral-medium);">
                            Please check your secret key and try again.
                        </p>
                    </div>
                `;
                document.getElementById('manualEntry').style.display = "block";
                document.getElementById('secretInput').classList.add('input-error');
            }
        }

        function formatCode(code) {
            // Add spacing for better readability
            return code.replace(/(\d{3})(\d{3})/, '$1 $2');
        }

        function updateCountdown(secret) {
            const remaining = 30 - Math.floor(Date.now() / 1000) % 30;
            const countdownElement = document.getElementById('countdown');
            const timerElement = document.querySelector('.timer');
            const codeElement = document.querySelector('.code');
            
            if (countdownElement) {
                countdownElement.textContent = remaining;
                
                // Update token if we're at the start of a new period
                if (remaining === 30) {
                    try {
                        const token = generateToken(secret);
                        if (codeElement) {
                            codeElement.textContent = formatCode(token);
                        }
                    } catch (error) {
                        console.error('Error updating token:', error);
                    }
                }
                
                // Dynamic timer styling - color the entire timer element
                if (remaining <= 5) {
                    if (timerElement) {
                        timerElement.style.setProperty('color', 'var(--status-error)', 'important');
                        timerElement.style.animation = 'pulse 0.5s infinite';
                        timerElement.style.fontWeight = 'bold';
                    }
                } else if (remaining <= 10) {
                    if (timerElement) {
                        timerElement.style.setProperty('color', 'var(--status-warning)', 'important');
                        timerElement.style.animation = 'pulse 1s infinite';
                        timerElement.style.fontWeight = 'bold';
                    }
                } else if (remaining <= 20) {
                    if (timerElement) {
                        timerElement.style.setProperty('color', 'var(--status-info)', 'important');
                        timerElement.style.animation = 'none';
                        timerElement.style.fontWeight = '600';
                    }
                } else {
                    if (timerElement) {
                        timerElement.style.setProperty('color', 'var(--status-success)', 'important');
                        timerElement.style.animation = 'none';
                        timerElement.style.fontWeight = '600';
                    }
                }
            }
        }

        function copyCode() {
            const codeElement = document.querySelector('.code');
            if (!codeElement) return;
            
            const code = codeElement.textContent.replace(/\s/g, ''); // Remove spaces
            navigator.clipboard.writeText(code).then(() => {
                showToast('Code copied! ‚úì');
            }).catch(err => {
                console.error('Failed to copy code:', err);
                showToast('Failed to copy code');
            });
        }

        function showToast(message) {
            const toast = document.getElementById('copyToast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        function clearInput() {
            document.getElementById('secretInput').value = '';
            document.getElementById('secretInput').classList.remove('input-error');
            document.getElementById('inputError').classList.remove('show');
            document.getElementById('secretInput').focus();
            // disable clear when nothing to clear
            const clearBtn = document.getElementById('clearBtn');
            if (clearBtn) clearBtn.disabled = true;
        }

        function goHome() {
            if (currentInterval) {
                clearInterval(currentInterval);
            }
            window.location.href = '/tools/easylogin/';
        }

        // Handle paste events for validation
        document.addEventListener('DOMContentLoaded', function() {
            const secretInput = document.getElementById('secretInput');
            const clearBtn = document.getElementById('clearBtn');
            const generateBtn = document.getElementById('generateBtn');
            if (clearBtn) clearBtn.disabled = true; // start muted
            if (generateBtn) generateBtn.disabled = true; // start disabled

            if (secretInput) {
                // On paste: auto-clean the input (remove spaces, dashes, underscores)
                secretInput.addEventListener('paste', function(e) {
                    setTimeout(() => {
                        const pastedValue = e.target.value || '';
                        // Clean the input automatically
                        const cleanedValue = cleanSecretInput(pastedValue);
                        if (cleanedValue !== pastedValue) {
                            this.value = cleanedValue;
                        }
                        // keep UI clean until user explicitly generates
                        secretInput.classList.remove('input-error');
                        document.getElementById('inputError').classList.remove('show');
                        if (clearBtn) clearBtn.disabled = !cleanedValue.trim();
                        
                        // Enable generate button only if input looks valid
                        const generateBtn = document.getElementById('generateBtn');
                        const isValid = cleanedValue.length >= 16 && /^[A-Z2-7]+=*$/i.test(cleanedValue);
                        if (generateBtn) generateBtn.disabled = !isValid;
                    }, 0);
                });

                // Auto-clean on input (as user types)
                secretInput.addEventListener('input', function() {
                    const currentValue = this.value;
                    const cleanedValue = cleanSecretInput(currentValue);
                    if (cleanedValue !== currentValue) {
                        this.value = cleanedValue;
                    }
                    
                    const generateBtn = document.getElementById('generateBtn');
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        this.classList.remove('input-error');
                        document.getElementById('inputError').classList.remove('show');
                        if (clearBtn) clearBtn.disabled = false;
                        
                        // Enable generate button only if input looks valid
                        const isValid = inputValue.length >= 16 && /^[A-Z2-7]+=*$/i.test(inputValue);
                        if (generateBtn) generateBtn.disabled = !isValid;
                    } else {
                        if (clearBtn) clearBtn.disabled = true;
                        if (generateBtn) generateBtn.disabled = true;
                    }
                });

                // Enter key support
                secretInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        startFromInput();
                    }
                });

                // Ensure clean state on load
                secretInput.classList.remove('input-error');
                document.getElementById('inputError').classList.remove('show');
                // Auto-focus if manual entry visible
                if (document.getElementById('manualEntry').style.display !== 'none') {
                    secretInput.focus();
                }
            }
        });

        (function initTOTP() {
            if (!window.otplib) {
                document.getElementById('mainDisplay').innerHTML = 
                    "<p class='loading-dots'>Loading TOTP library</p>";
                setTimeout(() => window.location.reload(), 2000);
                return;
            }

            const { authenticator } = window.otplib;

            generateToken = function(secret) {
                if (!secret) throw new Error('Secret is required');
                if (!isValidBase32(secret)) throw new Error('Invalid Base32 format');
                
                try {
                    return authenticator.generate(secret);
                } catch (error) {
                    throw new Error('Invalid secret key');
                }
            };

            // Extract secret from URL
            // Method 1: Hash (#SECRET) ‚Äî never sent to server, most private
            // Method 2: Query param (?secret=XXX)
            // Share links: fastaccs.com/tools/easylogin/#YOUR_SECRET
            function extractSecretFromURL() {
                // Hash method ‚Äî preferred, most private
                const hashSecret = window.location.hash.slice(1).trim();
                if (hashSecret) {
                    return cleanSecretInput(hashSecret);
                }

                // Query param fallback
                const urlParams = new URLSearchParams(window.location.search);
                const querySecret = urlParams.get('secret');
                if (querySecret && querySecret.trim()) {
                    return cleanSecretInput(querySecret.trim());
                }

                return null;
            }

            const extractedSecret = extractSecretFromURL();
            
            if (extractedSecret) {
                renderCode(extractedSecret);
            } else {
                // Show the manual entry form that already exists in the DOM
                document.getElementById('manualEntry').style.display = "block";
                // ensure clean error state on startup
                const secretInput = document.getElementById('secretInput');
                if (secretInput) {
                    secretInput.classList.remove('input-error');
                    document.getElementById('inputError').classList.remove('show');
                    secretInput.focus();
                }
            }
        })();

        // Handle page visibility changes to prevent timer drift
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden && currentInterval) {
                // Page became visible, refresh the code immediately
                const secretInput = document.getElementById('secretInput');
                
                // Use same extraction logic as init
                function getCurrentSecret() {
                    const hashSecret = window.location.hash.slice(1).trim();
                    if (hashSecret) return cleanSecretInput(hashSecret);

                    const urlParams = new URLSearchParams(window.location.search);
                    const querySecret = urlParams.get('secret');
                    if (querySecret && querySecret.trim()) return cleanSecretInput(querySecret.trim());

                    return secretInput ? cleanSecretInput(secretInput.value.trim()) : '';
                }
                
                const currentSecret = getCurrentSecret();
                if (currentSecret) {
                    updateCountdown(currentSecret);
                }
            }
        });
    </script>
</body>
</html>